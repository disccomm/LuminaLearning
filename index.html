<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lumina - AI Learning</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';</script>
    <script type="module">
        // Expose WebLLM to the global window object for app.js to use
        import * as webllm from "https://esm.run/@mlc-ai/web-llm";
        window.webllm = webllm;
    </script>
    </head>
<body>
    <div class="container">
        <header>
            <div class="logo">Lumina</div>
            <h4 style="text-align: right; line-height: 1.2;">
                Welcome back, <br><span style="font-size:1.2em; color:var(--primary-color);">Explorer</span>
            </h4>
            <button class="settings-btn" onclick="openSettingsModal()">
                <i class="fas fa-cog"></i>
                Settings
            </button>
        </header>

        <div id="hub-view" class="view active">
            
            <div class="glass-panel">
                <h3 style="color: var(--primary-color);">1. Define Your Source</h3>
                
                <label for="topic-name">Topic Name (e.g., Quantum Physics)</label>
                <input type="text" id="topic-name" placeholder="Enter topic..." value="Defence GK">
                
                <label for="age-range">Level:</label>
                <input type="range" id="age-range" min="5" max="25" value="12">
                <div id="age-val" style="text-align: right; margin-top: -10px; color: var(--primary-color);">12 yrs (Creator)</div>
                
                <div class="file-upload-area" style="border: 2px dashed var(--border-color); padding: 20px; border-radius: 12px; text-align: center; cursor: pointer; margin-bottom: 15px;" onclick="document.getElementById('pdf-file').click()">
                    <i class="fas fa-file-pdf" style="font-size: 1.5rem; opacity: 0.6;"></i>
                    <p id="file-status" style="margin: 5px 0 0 0;">Tap to Upload PDF</p>
                    <input type="file" id="pdf-file" accept=".pdf" style="display:none;">
                </div>
                
                <p id="ai-status" style="font-size: 0.9rem; margin-top: 0; color: #22c55e;">Ready to Analyze.</p>
                
                <button class="primary-btn" id="build-library-btn">
                    Build My Library
                </button>
            </div>

            <div class="glass-panel">
                <h3 style="color: var(--primary-color);">2. Choose Your Mode</h3>
                
                <div class="action-grid" id="action-tiles">
                    <div class="action-tile" onclick="startQuiz()">
                        <span class="tile-icon"><i class="fas fa-question-circle"></i></span>
                        Instant Quiz
                    </div>
                    <div class="action-tile">
                        <span class="tile-icon"><i class="fas fa-copy"></i></span>
                        Flashcards
                    </div>
                    <div class="action-tile">
                        <span class="tile-icon"><i class="fas fa-print"></i></span>
                        Worksheets
                    </div>
                </div>
            </div>
            
        </div>

        <div id="quiz-view" class="view">
            <header>
                <button onclick="openExitConfirmation()" class="settings-btn" style="opacity: 1; font-size: 1rem;"><i class="fas fa-times"></i> Exit X</button>
                <button class="settings-btn" disabled><i class="fas fa-pause"></i> Pause</button>
            </header>
            
            <div id="quiz-content">
                </div>
            
            <div style="margin-top: 20px; display: flex; gap: 10px;">
                <button class="close-btn" onclick="openExitConfirmation()" style="width: 30%;">Exit</button>
                <button class="primary-btn" id="next-btn" onclick="handleNext()" style="width: 70%;">Next Question</button>
            </div>
        </div>
    </div>

    <div id="modal-overlay" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 id="modal-title">Settings</h2>
            <button class="close-btn" style="position: absolute; top: 15px; right: 15px; width: auto; background: none; border: none;" onclick="document.getElementById('modal-overlay').classList.add('hidden')">
                <i class="fas fa-times" style="font-size: 1.5rem;"></i>
            </button>
            
            <div id="modal-body">
                </div>
        </div>
    </div>
    
    <script src="app.js"></script>
</body>
</html>